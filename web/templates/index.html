<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>今日头条</title>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>

<div>
      {% if not logged_in %}
            <ul class="nav nav-pills">
              <li class="active" onclick="clearError()"><a data-toggle="pill" href="#login">登录</a></li>
              <li onclick="clearError()"><a data-toggle="pill" href="#reset">重置密码</a></li>
              <li onclick="clearError()"><a data-toggle="pill" href="#admin">管理员登录</a></li>
            </ul>

            <div class="tab-content">
              <div id="login" class="tab-pane fade in active">
                    <form action="login" method="post">
                        <div>用户名: <input type="text" name="username"> </div>
                        <div>密码: <input type="password" name="password"> </div>
                        <input type="submit" value="登录">
                    </form>
              </div>
              <div id="reset" class="tab-pane fade">
                    <form action="reset" method="post">
                        <div>用户名: <input type="text" name="username"> </div>
                        <div>旧密码: <input type="password" name="old"> </div>
                        <div>新密码: <input type="password" name="new"> </div>
                        <input type="submit" value="重置">
                    </form>
              </div>
              <div id="admin" class="tab-pane fade">
                <button>管理员登录</button>
              </div>
            </div>
      {% else %}
        <div>欢迎! <button onclick="logout()">退出登录</button></div>
      {% endif %}
</div>

      {% if error %}
            <div> <p id="error" style="color: red"> {{ error }} </p> </div>
      {% else %}

      {% endif %}

  <div>
      {% if not logged_in %}
            <div> <p style="color: red"> 您无权查看监控 </p> </div>
      {% else %}
        <img src="main.jpg" id="main_image">
      {% endif %}
  </div>


</body>
<script type="text/javascript">
    admin = document.getElementById("admin");
    if(admin)
    {
    admin.onclick = function () {
        location.href = "admin";
    };
    }

    function logout() {
        location.href = "logout";
    }
    
    function clearError() {
        error = document.getElementById("error");
        if(error)
        {
        error.hidden = true;
        }
    }
    
    setInterval(function(){ 
    img = document.getElementById("main_image");
    if(img)
    {
    img.src = 'main.jpg?' + new Date().getTime();;
    }
    }, 50);

</script>
</html>